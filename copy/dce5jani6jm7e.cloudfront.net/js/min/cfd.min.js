var path=$("script[data-src]").data("src"),loadedCharts=[],cfdQuotes=function(r){var e,o,l=this,t=r.url,n=$("#"+r.element),i=(r.type,[]),c=[],h="",s=r.pairs,p=r.pairsName,d="",u=r.fullPathUrl;o=_.template('<tr><td><a class="black-text font-bold" href="{{= page_path }}/{{= key_name }}">{{= name }}</a></td><td><span class="{{= check(val.bid, localBid) }}">{{= val.bid }}</span></td><td><strong>{{= val.spread }}</strong></td><td><span class="{{= check(val.ask, localAsk) }}">{{= val.ask }}</span></td><td class="hidden-xs"><a href="{{= link }}" target="_blank" class="btn btn-pink-light analyt-buy-sell">Sell</a> <a href="{{= link }}" target="_blank" class="btn btn-turquoise analyt-buy-sell">Buy</a></td></tr></tr>'),p=p.split(","),this.check=function(t,e){var s=e==t;return e<t?s?"":"pink-bg-lighten animated":s?"":"turquoise-bg-lighten animated"},this.process=function(t){e=_.property("result")(t),e=_.omit(e,"success"),_.delay(l.getJson,2e3);var a=0;_.each(e,function(t,e){var s=e.replace("-Pro","").replace("-ECN","");s.toLowerCase().replace(/[^0-9a-z]/gi,"");d=t.bid>i[e]?"danger-bg-lighten animated":t.ask<c[e]?"success-bg-lighten animated":"",h+=o({page_path:u,name:s,key_name:p[a],val:t,nclass:d,check:l.check,localBid:i[e],localAsk:c[e],link:r.link}),n.html(h),i[e]=t.bid,c[e]=t.ask,a++}),h=""},this.getJson=function(){$.getJSON(t,{pair:s},l.process)},l.getJson()},cfdOpportunities=function(t){var e,a,r=this,s=t.url,o=$("#"+t.element),l=t.currency,n=t.product,i=t.lang,c=t.u_id,h=t.timer,p=[],d="";a=_.template('<div class="col-sm-4 opps"><div class="forex-opportunities"><div class="forex-opportunities__content"><h5 class="forex-opportunities__title m-b-xs">{{= val.symbol }}</h5><p>{{= val.close_description}}</p><h5 class="forex-opportunities__title m-y-xs"><span class="{{= check(val.pnl_result, localBid, val.pnl) }}">{{= val.pnl}} {{= val.pnl_result}} {{= val.currency}}</span></h5><p class="with-ico"><svg height="14" width="14" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14"><path fill="#4a5470" fill-rule="evenodd" d="M 7 0 C 3.14 0 0 3.14 0 7 C 0 10.86 3.14 14 7 14 C 8.87 14 10.63 13.27 11.95 11.95 C 13.27 10.63 14 8.87 14 7 C 14 3.14 10.86 0 7 0 L 7 0 Z M 10.98 10.98 C 9.92 12.04 8.5 12.63 7 12.63 C 3.89 12.63 1.38 10.11 1.38 7 C 1.38 3.89 3.89 1.38 7 1.38 C 10.11 1.38 12.63 3.89 12.63 7 C 12.63 8.5 12.04 9.92 10.98 10.98 L 10.98 10.98 Z M 7.71 2.86 L 6.29 2.86 L 6.29 7.54 L 9.91 9.75 L 10.66 8.54 L 7.71 6.73 L 7.71 2.86 Z M 7.71 2.86" /></svg>&nbsp;<span>{{= val.close_time }}</span></p></div><div class="forex-opportunities__footer"><p class="with-ico"><svg height="14" width="14" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14"><path fill="#4a5470" fill-rule="evenodd" d="M 7 0 C 3.13 0 0 3.13 0 7 C 0 10.86 3.13 14 7 14 C 10.87 14 14 10.86 14 7 C 14 3.13 10.87 0 7 0 L 7 0 Z M 8.99 10.14 C 8.65 9.86 8.52 9.56 8.52 9.24 C 8.52 8.67 8.98 7.96 9.34 7.23 C 9.77 6.37 9.69 5.82 9.63 5.61 C 9.7 5.37 9.76 4.96 9.76 4.49 C 9.76 3.19 9.21 1.76 7.65 1.76 C 7.4 1.76 7.13 1.8 6.84 1.87 C 4.89 1.87 4.15 3.04 4.15 4.46 C 4.15 5.11 4.29 5.66 4.35 5.87 C 4.31 6.01 4.3 6.15 4.3 6.28 C 4.3 7.4 5.37 7.59 5.37 9.13 C 5.37 9.5 5.26 9.85 4.98 10.16 C 3.61 10.73 2.91 11.07 2.33 11.51 C 1.2 10.34 0.5 8.76 0.5 7 C 0.5 3.41 3.41 0.5 7 0.5 C 10.59 0.5 13.5 3.41 13.5 7 C 13.5 8.79 12.77 10.42 11.6 11.59 C 10.52 10.64 9.27 10.22 8.99 10.14 L 8.99 10.14 Z M 8.99 10.14" /></svg>&nbsp;<strong>{{= val.name}}</strong><span>, {{= val.country}}</span></p></div></div></div>'),this.check=function(t,e,s){var a=e==t;return"earned"===s.toLowerCase()?a?"":"turquoise-bg-lighten animated":a?"":"pink-bg-lighten animated"},this.reverseObjectList=function(s){var a=[];_.each(s,function(t,e){a.push(e)});var r=a.length-1,o=[];return _.each(s,function(t,e){o.push(s[r]),r--}),o},this.process=function(t){e=_.property("result")(t),e=_.omit(e,"success"),_.delay(r.getJson,h);var s=0;_.each(r.reverseObjectList(e),function(t,e){s&&s%3==0&&(d+='<div class="row"></div>'),d+=a({val:t,localBid:p[e],check:r.check}),o.html(d),p[e]=t.pnl_result,s++}),d=""},this.getJson=function(){$.getJSON(s,{currency:l,product:n,lang:i,u_id:c},r.process)},r.getJson()};function getInstrumentCharts(t){$.getJSON(path?path+"charts_instrument_cfd":"/assets/components/quotes/charts-instrument-cfd.php",{name:t},function(t){var e='<i class="fa fa-{{arrow}} text-{{color}}" aria-hidden="true"></i>',s=t.result,a=s.direction.toLowerCase(),r="up"===a?e.replace("{{arrow}}","arrow-up").replace("{{color}}","success"):"absent"===a?e.replace("{{arrow}}","arrows-v").replace("{{color}}","info"):e.replace("{{arrow}}","arrow-down").replace("{{color}}","danger");$("#direction").html(r),$("#median-price").text(s.medianPrice),$("#change").text(s.change),$("#open-price").text(s.openPrice),$("#high-price").text(s.highPrice),$("#low-price").text(s.lowPrice),$("#pips-change").text(s.pipsChange),$("#buy").text(t.result.askPrice),$("#sell").text(t.result.bidPrice)})}var stopFetchBuySell=!1;function getBuySell(s){stopFetchBuySell||(s=s.replace("-Pro",""),$.getJSON(path?path+"quotes_cfd":"/assets/components/quotes/quotes-cfd.php",{pair:s},function(t){if(t.result){if(t.result[s]&&($("#buy").html(t.result[s].ask),$("#sell").html(t.result[s].bid),$("#buy_sell_median").length)){var e=(parseFloat(t.result[s].ask)+parseFloat(t.result[s].bid))/2;$("#buy_sell_median").html(e.toFixed(3))}}else stopFetchBuySell=!0}))}var stockChart=function(t,e,s,a,r){var o=t.replace("#","@").replace("-Pro","");e=e||"chart",s=s||"month",a=a||60,r=r||"chart";Highcharts.theme={colors:["#237dea","#50B432","#ED561B","#DDDF00","#24CBE5","#64E572","#FF9655","#FFF263","#6AF9C4"],title:!1,legend:{enabled:!1},background2:"#F0F0EA"},Highcharts.setOptions(Highcharts.theme);var l=[],n={chart:{renderTo:e},credits:{enabled:!1},scrollbar:{enabled:!1},navigator:{enabled:!1},yAxis:[{opposite:!1,showLastLabel:!0,showEmpty:!1},{opposite:!0,linkedTo:0,gridLineWidth:1,gridLineColor:"#d72a34",tickPositions:null}],xAxis:{showEmpty:!1},buttonTheme:{fill:"none",stroke:"stroke","stroke-width":1,r:4,width:60,style:{color:"#333",fontWeight:"bold"},states:{hover:{fill:"#4a5470",style:{color:"white"}},select:{fill:"#4a5470",style:{color:"white"}}}},tooltip:{borderWidth:1,backgroundColor:"white",borderColor:"#e1e1eb",borderRadius:4,shadow:"0 10px 30px rgba(14, 41, 76, 0.08)",useHTML:!0,formatter:function(){var s="",a=l.length;return $.each(this.points,function(t,e){for(t=0;t<a;t++)if(l[t][0]==e.point.x){s+='<table><tr><th colspan="2">'+l[t][5]+"</th></tr><tr><td><strong>Open:</strong></td><td>"+l[t][1]+"</td></tr><tr><td><strong>Close:</strong></td><td>"+l[t][4]+"</td></tr><tr><td><strong>High:</strong></td><td>"+l[t][2]+"</td></tr><tr><td><strong>Low:</strong></td><td>"+l[t][3]+"</td></tr></table>";break}}),s||!1}},rangeSelector:{enabled:!1,buttons:[{type:"hour",count:1,text:"1 Hour"},{type:"hour",count:4,text:"4 Hours"},{type:"day",count:1,text:"1 Day"},{type:"week",count:1,text:"1 Week"}],selected:2,inputEnabled:!1,buttonSpacing:30,labelStyle:{display:"none"},buttonTheme:{fill:"none",stroke:"stroke","stroke-width":1,r:4,width:60,style:{color:"#333",fontWeight:"bold"},states:{hover:{fill:"#4a5470",style:{color:"white"}},select:{fill:"#4a5470",style:{color:"white"}}}}},series:[{data:l}]};$.getJSON(path?path+"ticks_cfd":"/assets/components/ticks/ticks-cfd.php",{name:o,range:s,period:a},function(t){if(t){for(var e=t.length,s=0;s<e;s+=1)l.push([1e3*new Date(t[s].time).getTime(),t[s].open,t[s].high,t[s].low,t[s].close,t[s].date]);l[l.length-1]&&(n.yAxis[1].tickPositions=[l[l.length-1][1]],window[r]=new Highcharts.StockChart(n),loadedCharts.push(o))}})};$(".toggle-graph").on("click",function(t){var e=$(this).parent().data("group"),s=$(this).data("pair"),a=$(this).data("target"),r=$(".group-"+e);$(this).parent().find(".toggle-graph").removeClass("active"),$(this).addClass("active"),t.preventDefault(),this.switchChart=function(){r.hide(),$("#"+a).fadeIn()},-1==$.inArray(s,loadedCharts)&&new stockChart(s,a),this.switchChart()});